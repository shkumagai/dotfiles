#!/bin/bash

PWD=$(cd $(dirname $0); pwd)
TMUX_ROOT=$(cd $PWD/..; pwd)
source ${TMUX_ROOT}/bin/utils

WINDOW_NAME=$(basename $0)

function main
{
    get-passwds
    # rows=$(get-row-per-host 5)
    rows=10

    tmux neww -n ${WINDOW_NAME}
    tmux splitw -h -t ${WINDOW_NAME}

    tmux selectp -t 0;  tmux splitw -v -t ${WINDOW_NAME}.0;  sleep 0.3;  tmux resizep -y ${rows} -t ${WINDOW_NAME}.0
    tmux selectp -t 1;  tmux splitw -v -t ${WINDOW_NAME}.1;  sleep 0.3;  tmux resizep -y ${rows} -t ${WINDOW_NAME}.1
    tmux selectp -t 2;  tmux splitw -v -t ${WINDOW_NAME}.2;  sleep 0.3;  tmux resizep -y ${rows} -t ${WINDOW_NAME}.2
    tmux selectp -t 3;  tmux splitw -v -t ${WINDOW_NAME}.3;  sleep 0.3;  tmux resizep -y ${rows} -t ${WINDOW_NAME}.3
    tmux selectp -t 4;  tmux splitw -v -t ${WINDOW_NAME}.4;  sleep 0.3;  tmux resizep -y ${rows} -t ${WINDOW_NAME}.4
    tmux selectp -t 5;  tmux splitw -v -t ${WINDOW_NAME}.5;  sleep 0.3;  tmux resizep -y ${rows} -t ${WINDOW_NAME}.5
    tmux selectp -t 6;  tmux splitw -v -t ${WINDOW_NAME}.6;  sleep 0.3;  tmux resizep -y ${rows} -t ${WINDOW_NAME}.6
    tmux selectp -t 7;  tmux splitw -v -t ${WINDOW_NAME}.7;  sleep 0.3;  tmux resizep -y ${rows} -t ${WINDOW_NAME}.7

    tmux send -t ${WINDOW_NAME}.0  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-202 '$@'" C-m
    tmux send -t ${WINDOW_NAME}.2  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-207 '$@'" C-m
    tmux send -t ${WINDOW_NAME}.4  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-208 '$@'" C-m
    tmux send -t ${WINDOW_NAME}.6  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-209 '$@'" C-m
    tmux send -t ${WINDOW_NAME}.8  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-210 '$@'" C-m
    tmux send -t ${WINDOW_NAME}.1  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-211 '$@'" C-m
    tmux send -t ${WINDOW_NAME}.3  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-212 '$@'" C-m
    tmux send -t ${WINDOW_NAME}.5  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-213 '$@'" C-m
    tmux send -t ${WINDOW_NAME}.7  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-214 '$@'" C-m
    tmux send -t ${WINDOW_NAME}.9  "$TMUX_ROOT/bin/automate.sh dwh-master-01/dwh-engine-215 '$@'" C-m
}

# run
main "$@"
